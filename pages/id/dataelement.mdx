# API Elemen Data

Endpoint API ini mengambil elemen data berdasarkan kriteria pencarian seperti judul, kategori, sumber data, sektor, dan bidang. Endpoint ini juga mendukung pencarian menggunakan pola regex pada kriteria tersebut.

## Endpoint

`GET /api/v1/data-element`

### Parameter Query

- `title` (string, opsional): Mencari elemen data berdasarkan judul. Menggunakan regex untuk pencocokan yang tidak peka huruf besar/kecil.
- `category` (string, opsional): Memfilter berdasarkan kategori. Nilai `category` harus berupa `slug` dari kategori.
- `dataSource` (string, opsional): Memfilter berdasarkan sumber data. Nilai `dataSource` harus berupa `slug` dari sumber data.
- `sector` (string, opsional): Memfilter berdasarkan sektor. Nilai `sector` harus berupa `slug` dari sektor.
- `field` (string, opsional): Memfilter berdasarkan bidang. Nilai `field` harus berupa `slug` dari bidang.

### Respon

- `200 OK`: Mengembalikan array elemen data yang sesuai dengan kriteria pencarian. Setiap elemen data mencakup bidang berikut:
  - `_id`: Pengidentifikasi unik dari elemen data.
  - `title`: Judul elemen data.
  - `unit`: Satuan dari elemen data.
  - `data`: Data aktual.
  - `metadata`: Metadata tentang elemen data.
  - `status`: Status elemen data (dalam hal ini, memfilter berdasarkan status `"TERVERIFIKASI"`).
  - `sector`: Bidang yang diisi dengan nama dan slug sektor.
  - `field`: Bidang yang diisi dengan nama dan slug bidang.
  - `dataSource`: Bidang yang diisi dengan nama dan slug sumber data.
  - `category`: Bidang yang diisi dengan nama dan slug kategori.

#### Contoh Permintaan

```bash
GET https://next-ksd.pekalongankab.go.id/api/v1/data-element?title=Jumlah%20Posyandu&category=data-sektoral&sector=kesehatan&dataSource=dinkes
```

#### Contoh Respon

```json
[
  {
    "_id": "66973c799c383342abc479c2",
    "title": "Jumlah Posyandu Menurut Puskesmas",
    "category": [
      {
        "_id": "6657e68cc06ece4ffdecfb80",
        "name": "Data Sektoral",
        "slug": "data-sektoral"
      }
    ],
    "dataSource": {
      "_id": "6657e68fc06ece4ffdecfb94",
      "name": "Dinas Kesehatan",
      "slug": "dinkes"
    },
    "field": [],
    "unit": "Unit",
    "data": [
      {
        "id": "fabfd658-d414-460b-9c1f-11a3cfa8cea7",
        "year": 2022,
        "table": {
          "headers": [
            {
              "content": "Nama Puskesmas",
              "colSpan": 1,
              "rowSpan": 2,
              "dataType": "number"
            },
            {
              "content": "Strata Posyandu",
              "colSpan": 4,
              "rowSpan": 1,
              "dataType": "number"
            },
            {
              "content": "Posyandu Aktif",
              "colSpan": 1,
              "rowSpan": 2,
              "dataType": "number"
            }
          ],
          "subHeaders": [["Pratama", "Madya", "Purnama", "Mandiri"]],
          "rows": [
            ["Kandangserang", "0", "3", "55", "12", "67"],
            ["Paninggaran", "2", "16", "25", "20", "45"],
            ["Lebakbarang", "0", "2", "18", "15", "33"],
            ["Petungkriyono", "0", "0", "35", "3", "38"],
            ["Talun", "0", "0", "2", "58", "60"],
            ["Doro 1", "1", "0", "30", "9", "39"],
            ["Doro 2", "0", "0", "25", "8", "33"],
            ["Karanganyar", "0", "25", "28", "27", "55"],
            ["Kajen 1", "0", "0", "6", "51", "57"],
            ["Kajen 2", "0", "21", "33", "7", "40"],
            ["Kesesi 1", "0", "8", "38", "15", "53"],
            ["Kesesi 2", "0", "0", "30", "16", "46"],
            ["Sragi 1 ", "0", "0", "35", "13", "48"],
            ["Sragi 2", "0", "0", "20", "32", "52"],
            ["Siwalan", "0", "0", "21", "38", "59"],
            ["Bojong 1", "0", "0", "13", "42", "55"],
            ["Bojong 2", "0", "7", "14", "23", "37"],
            ["Wonopringgo", "1", "9", "35", "35", "70"],
            ["Kedungwuni 1", "0", "7", "30", "31", "61"],
            ["Kedungwuni 2", "0", "0", "11", "24", "35"],
            ["Karangdadap", "0", "10", "20", "32", "52"],
            ["Buaran", "0", "1", "30", "23", "53"],
            ["Tirto 1", "0", "1", "34", "29", "63"],
            ["Tirto 2", "0", "0", "14", "7", "21"],
            ["Wiradesa", "0", "0", "2", "68", "70"],
            ["Wonokerto 1", "0", "0", "28", "5", "33"],
            ["Wonokerto 2", "0", "11", "2", "0", "2"]
          ]
        }
      }
    ],
    "metadata": [
      {
        "key": "Nama Kegiatan",
        "value": ""
      },
      {
        "key": "Nama Variabel",
        "value": ""
      },
      {
        "key": "Alias",
        "value": ""
      },
      {
        "key": "Konsep",
        "value": ""
      },
      {
        "key": "Definisi",
        "value": ""
      },
      {
        "key": "Referensi Pemilihan",
        "value": ""
      },
      {
        "key": "Referensi Waktu",
        "value": ""
      },
      {
        "key": "Tipe Data",
        "value": ""
      },
      {
        "key": "Klasifikasi Isian",
        "value": ""
      },
      {
        "key": "Aturan Validasi",
        "value": ""
      },
      {
        "key": "Kalimat Pertanyaan",
        "value": ""
      },
      {
        "key": "Apakah Dapat Diakses Umum?",
        "value": ""
      }
    ],
    "status": "TERVERIFIKASI",
    "sector": [
      {
        "_id": "66e290869729bf5d8017fff6",
        "name": "Kesehatan",
        "slug": "kesehatan"
      }
    ]
  }
]
```

- `404 Not Found`: Dikembalikan jika kategori, sumber data, sektor, atau bidang yang ditentukan oleh slug dalam parameter query tidak ditemukan.

#### Contoh Respon Error

```json
{
  "error": "Kategori tidak ditemukan. Pastikan slug sudah benar. Daftar kategori dan slug-nya dapat ditemukan di /api/v1/category",
  "status": 404
}
```

- `400 Bad Request`: Dikembalikan jika terjadi kegagalan dalam pengambilan data.

#### Contoh Respon Error

```json
{
  "message": "Gagal mengambil data."
}
```

---

Untuk informasi lebih lanjut tentang slug yang tersedia untuk kategori, sumber data, sektor, dan bidang, silakan merujuk ke endpoint masing-masing:

- [`/api/v1/category`](/category)
- [`/api/v1/data-source`](/datasource)
- [`/api/v1/sector`](/sector)
- [`/api/v1/field`](/field)
